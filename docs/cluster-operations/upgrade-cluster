---
id: upgrading-cluster
title: Upgrading IOMesh Cluster
sidebar_label: Upgrading IOMesh Cluster
---

> Note: You cannot upgrade the IOMesh cluster if it only has one meta Pod and one chunk Pod.

> Note: 由于 K8s CRD 升级机制的限制，从 v0.11.1 版本升级到 v1.0.0 版本的 IOMesh 集群不支持运行在 K8s v1.25 及以上版本的 K8s 集群中.

Due to the limitations of the K8s CRD upgrade mechanism, upgrades are not supported if the Kubernetes cluster version is 1.25 or above.

**Procedure**

1. Delete the default StorageClass. 

    The default StorageClass for IOMesh 1.0, compared to the default StorageClass of an earlier version, has parameters updated. You need to delete the earlier one, and any PVC based on it will not be affected.


    ```shell
    kubectl delete sc iomesh-csi-driver
    ```
2. Temporarily disable IOMesh Webhook. 

   IOMesh Webhook may cause the upgrade to fail. Run the following command to disable it temporarily, and it will be installed back automatically once the upgrade is successful.

    ```shell
    kubectl delete Validatingwebhookconfigurations iomesh-validating-webhook-configuration
    ```
3. Install the CRD of IOMesh 1.0.

    ```shell
    kubectl apply -f https://iomesh.run/config/crd/iomesh.com_blockdevicemonitors.yaml
    ```
4. Upgrade the IOMesh cluster. Then wait for a few minutes till all pods are ready.

    ```bash
    helm upgrade --namespace iomesh-system iomesh iomesh/iomesh --version v1.0.0
    ```
5. Verify that all pods are ready. If all pods are shown in the `Ready` state, then IOMesh has been successfully upgraded.
    ```bash
    watch kubectl get pod --namespace iomesh-system
    ```
